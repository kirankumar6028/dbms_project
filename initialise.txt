# USER TABLE
CREATE TABLE IF NOT EXISTS user (
    user_id INT AUTO_INCREMENT PRIMARY KEY,
    fname VARCHAR(20),
    lname VARCHAR(20),
    email VARCHAR(30),
    password VARCHAR(30),
    contact_number CHAR(10)
);


# TRAVEL_AGENCY TABLE
CREATE TABLE IF NOT EXISTS travel_agency (
    agency_id CHAR(5) PRIMARY KEY, 
    agency_name VARCHAR(30), 
    location VARCHAR(30), 
    email VARCHAR(30), 
    contact_number CHAR(10)
);


# BUS TABLE
CREATE TABLE IF NOT EXISTS bus (
    bus_number CHAR(6) PRIMARY KEY, 
    source VARCHAR(20), 
    depature_time TIME, 
    destination VARCHAR(20), 
    arrival_time TIME, 
    duration TIME AS (arrival_time - depature_time), 
    fare INT, 
    agency_id CHAR(5), 
    seats_available INT, 
    FOREIGN KEY (agency_id) REFERENCES travel_agency(agency_id) ON DELETE CASCADE
);


# TOURS TABLE
CREATE TABLE IF NOT EXISTS tours (
    tour_id CHAR(6) PRIMARY KEY, 
    source VARCHAR(30), 
    description TEXT, 
    images VARCHAR(50), 
    no_of_days INT, 
    no_of_nights INT, 
    price INT, 
    seats_available INT, 
    start_date DATE
);


# TICKETS TABLE
CREATE TABLE IF NOT EXISTS tickets (
    ticket_id CHAR(8) PRIMARY KEY, 
    user_id INT, 
    date_of_booking DATE, 
    bus_number CHAR(6), 
    tour_id CHAR(6), 
    no_of_people INT, 
    total_price INT,
    FOREIGN KEY (user_id) REFERENCES user (user_id) ON DELETE CASCADE,
    FOREIGN KEY (tour_id) REFERENCES tours (tour_id) ON DELETE CASCADE,
    FOREIGN KEY (bus_number) REFERENCES bus (bus_number) ON DELETE CASCADE
);